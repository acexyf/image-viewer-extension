# PicFlow - Chrome 图片弹框查看器

一个优雅、功能完善的 Chrome 浏览器扩展，允许用户通过单击网页上的任何图片，在沉浸式全屏弹框中查看，并支持放大、缩小、旋转等操作。

## ✨ 核心功能

*   **一键全屏查看**：单击网页上的任意图片，即刻进入无干扰的全屏查看模式。
*   **流畅的图片操作**：
    *   **缩放**：使用鼠标滚轮、快捷键（`Ctrl/Cmd + +/-`）或界面按钮进行缩放。
    *   **旋转**：点击旋转按钮或按 `R` 键顺时针旋转图片。
    *   **重置**：一键将图片恢复到原始尺寸和角度。
*   **直观的控制界面**：半透明浮动控制栏，提供所有操作按钮。
*   **灵活的开关控制**：通过扩展的弹出窗口（Popup），随时启用或禁用插件的图片点击功能。
*   **智能图片识别**：自动过滤小尺寸图标，只为有意义的图片添加点击功能。

## 📦 安装与使用

### 开发模式安装（用于测试）

1.  **下载或克隆本项目代码**。
2.  打开 Chrome 浏览器，进入扩展程序管理页面 (`chrome://extensions/`)。
3.  打开右上角的 **“开发者模式”** 开关。
4.  点击 **“加载已解压的扩展程序”** 按钮。
5.  选择本项目所在的根文件夹（包含 `manifest.json` 的目录）。
6.  安装成功后，扩展图标将出现在浏览器工具栏中。

### 使用方法

1.  **启用功能**：点击工具栏中的 PicFlow 图标，在弹出的面板中确保开关已打开（默认开启）。
2.  **查看图片**：浏览任何网页时，将鼠标移至图片上，光标会变为指针。**单击**图片即可全屏查看。
3.  **操作图片**：
    *   在弹框中，使用屏幕底部的按钮进行 **放大 (+)**、**缩小 (-)**、**旋转 (↻)** 和 **重置 (↺)**。
    *   使用 **鼠标滚轮** 快速缩放。
    *   按 **`ESC`** 键或点击弹框背景可退出全屏查看。
    *   其他快捷键：`Ctrl/Cmd + R`（旋转），`Ctrl/Cmd + 0`（重置）。

## 🛠 项目结构

```
PicFlow-Chrome-Extension/
├── manifest.json               # 扩展配置文件 (Manifest V3)
├── popup/                      # 弹出窗口(Popup)文件
│   ├── popup.html
│   ├── popup.js
│   └── popup.css
├── content/                    # 内容脚本(Content Scripts)，注入网页
│   ├── content.js              # 核心功能逻辑（图片检测、弹框交互）
│   └── content.css             # 弹框样式
├── background/                 # 后台脚本(Service Worker)
│   └── background.js           # 管理扩展状态
└── assets/                     # 静态资源
    ├── icon16.png              # 扩展图标 (16x16)
    ├── icon48.png              # 扩展图标 (48x48)
    └── icon128.png             # 扩展图标 (128x128)
```

## ⚙️ 技术栈与实现

*   **Manifest V3**：使用最新的 Chrome 扩展平台规范，确保安全性和性能。
*   **内容脚本 (Content Script)**：动态注入网页，为图片绑定点击事件，并渲染交互式弹框。
*   **MutationObserver API**：监听 DOM 变化，自动为新加载的图片绑定功能，兼容动态网页。
*   **Chrome Storage API**：本地存储用户的扩展启用/禁用偏好。
*   **响应式设计**：弹框和控件适配不同屏幕尺寸和图片比例。

## 📝 发布指南（上传至 Chrome 网上应用店）

### 准备发布包
1.  确保所有代码功能正常，并在 `chrome://extensions/` 中测试无误。
2.  将所有必要文件（排除开发文档、`.git`目录等）**打包成 ZIP 文件**。`manifest.json` 必须在 ZIP 包的根目录。

### 上传步骤
1.  访问 [Chrome Web Store 开发者控制台](https://chrome.google.com/webstore/devconsole)。
2.  支付一次性 **$5 美元的开发者注册费**。
3.  点击 **“新增项目”**，上传你的 ZIP 包。
4.  填写详细的商品信息：
    *   **名称**、**简短描述**、**详细描述**（列出功能亮点）。
    *   上传商店图标（440x280）、宣传图（1400x560）和至少一张截图（1280x800 或 640x400）。
5.  **关键：填写“隐私权实践”**。对本插件使用的权限做出清晰解释：
    *   `activeTab`: “用于在用户点击图片时，获取当前活动标签页的内容以显示全屏弹框。”
    *   `storage`: “用于在本地保存用户对扩展功能的开启/关闭偏好设置。”
    *   `host_permissions` (`<all_urls>`): “为了能够检测并处理用户在所有网站页面上点击的图片，需要访问所有网页的权限。”
6.  根据欧盟法律要求，声明您的发布者身份为 **“交易者 (Trader)”** 或 **“非交易者 (Non-trader)”**（详见下方说明）。
7.  提交审核，通常需要 **3-7个工作日**。

## ⚖️ 关于“交易者/非交易者”的法律声明

根据欧洲经济区 (EEA) 消费者保护法律，在发布时需要声明您的账号属性：

*   **非交易者 (Non-trader)**：如果您是**个人开发者**，开发此插件**纯粹出于个人兴趣或学习目的**，且**插件完全免费，无任何商业获利计划**，请选择此项。
*   **交易者 (Trader)**：如果您开发此插件与您的**贸易、商业、手艺或职业有关**（例如您是个体户、公司，或插件包含付费/盈利计划），请选择此项。

> **重要提示**：即使初始选择“非交易者”，如果未来插件增加任何付费功能，**必须**返回控制台将状态更新为“交易者”。

## 🔧 常见问题与调试

*   **错误：“Receiving end does not exist”**
    这是内容脚本通信的常见问题。通常是因为弹出窗口(Popup)打开时，内容脚本尚未在目标网页完全加载。插件代码中已包含错误处理，可安全忽略，不影响核心功能。

*   **扩展在某些网站上不工作？**
    Chrome 内部页面（如 `chrome://` 开头）、某些安全限制严格的页面或 iframe 中的图片可能无法响应。

*   **如何修改缩放灵敏度或快捷键？**
    可以编辑 `content/content.js` 文件中的 `zoomIn`, `zoomOut` 方法以及 `keyboardHandler` 函数。

## 📄 许可证

本项目采用 [MIT 许可证](LICENSE)。您可以自由地使用、修改和分发此代码。

## 📦 更新日志

### 【v1.0.3】

todo

#### ✨ 新增功能
- 弹框底部添加图片列表
- 弹框左右添加上一个和下一个按钮
- 弹框按钮列表放到右上角，添加下载功能按钮
- 弹框旋转、重置按钮改为顺时针和逆时针旋转90度。

### 【v1.0.2】

#### 🔧 Bug修复
- popup页面上，点击启用和禁用按钮后，不刷新浏览的页面没有效果，改为Service Worker广播状态。

### 【v1.0.1】

#### 🎉 初始版本
- 点击页面图片以弹框形式查看
- 放大、缩小和旋转

## 🤝 贡献

欢迎提交 Issues 和 Pull Requests 来帮助改进此项目。

---
**希望 PicFlow 能为你带来流畅的看图体验！**